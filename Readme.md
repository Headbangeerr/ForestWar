**游戏项目已经打包到ForestWarGame目录中，直接运行文件中的“ForestWar.exe”即可运行游戏，服务器端已经发布到阿里服务器，进入游戏可以直接连接到服务器。**
 
#### 基本操作
w a s d控制角色移动，鼠标点击发射箭矢，双方角色初始HP值为100，每次攻击伤害为1-10随机数，双方任意一方HP值为0游戏结束。




框架设计整理总结
================
[toc]

服务器端框架设计
----------------
**一、 层次介绍**  

1. Server层
- Server类  
用于创建与客户端的连接，并将所有连接以List集合形式保存，便于管理。同时需要维护服务器中所有的房间列表。
- Client类  
用于接收来自客户端的请求，与向客户端发送响应。
- Message类  
用于解析与包装数据。由于服务器端与客户端收发数据都是以字节数组的形式。因此就需要使用该类进行统一的数据解析与包装。  
**同时为了解决Tcp协议中的粘包问题，** 服务器端与客户端之间的字节数组格式被规定为如下格式：
```c
   /*
         *    |  *   *   *   *  |*RequestCode*|*ActionCode* |------------data-----------------|
         *    | 数据长度标志位  |请求编号(int)|方法编号(int)|       请求中的数据内容          |
         *    
         */
```
每次接收到字节数组数据的前四个字节必须是必须是一个int32类型的数据，用于标识客户端发送的数据总字节数。如果在服务器接收到的实际数据长度小于长度标志位中的长度，那么则代表接收到的数据不完整，那么先将目前不完整的数据存入缓存数组中，然后等待下一次的客户端发送的数据，直至等到本地接收到的数据长度不小于长度标志位的长度时，再开始解析。

- Room类  
用于管理游戏房间内的房间信息，以及房间内的客户端连接对象，同时也负责想房间内的所有玩家进行广播。

2. Controller层  
用于处理来自客户端的请求，进行服务器层面的游戏逻辑处理。  
在这个层次中，ControllerManager类用于管理所有Controller对象，并负责根据具体的请求，通过反射机制调用对应Contrller对象中的对应的方法，处理请求。
3. Dao层  
用于处理具体的数据库操作。
4. Model层  
与数据库相对应的实体类。
### 服务器端框架UML图  
![image](https://note.youdao.com/yws/api/personal/file/267971D0E61B422AA79BEBE2DECC33B5?method=download&shareKey=9a52841fbed1fa6e9698851bd9e3822e)

客户端框架设计
----------------
**一、 层次介绍** 
1. Net层  
用于创建与服务器端的连接，向服务器端发送请求与解析来自服务器端的响应数据。
2. Request层  
用于发送具体的请求，每一种请求对应着服务器中Controller的一个具体的方法。
3. Manager层  
这个层次中包含着各个模块的管理者对象，各个管理者只负责提供对应模块的接口。  
这里利用中介者模式，将所有管理者的接口都集中到一个GameFacade对象中。其他层次的对象只可以通过GameFacade暴露的接口来调用各个管理者的资源，从而降低耦合度。
4. Player层  
用于处理游戏角色的操作以及游戏逻辑的处理。
5. UIPanel层  
 用于处理各个UI面板的操作。这里通过堆栈结构实现各个面板的切换。
6. Model层  
 数据实体类

### 客户端架构UML图
![image](https://note.youdao.com/yws/api/personal/file/412A62B2C2854B75A849B21AAAFA3CB3?method=download&shareKey=d23e256a3b9b05b129a69b39e453eb6a)
